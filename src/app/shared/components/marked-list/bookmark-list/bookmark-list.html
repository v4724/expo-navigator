@if (!fetchEnd()) {
  <mat-icon
    class="animate-spin"
    aria-hidden="false"
    aria-label="auto renew"
    fontIcon="autorenew"
  ></mat-icon>
}
@if (allList().length) {
  <div class="flex flex-col">
    <p-accordion value="0">
      @for (bookmark of allList(); track bookmark) {
        <p-accordion-panel [value]="$index">
          <p-accordion-header>
            <div class="w-full flex items-center py-1 gap-x-2">
              <p-checkbox
                size="small"
                [binary]="true"
                [(ngModel)]="bookmark.show"
                (onChange)="toggleList(bookmark)"
                (click)="$event.stopPropagation()"
              />
              <button class="flex items-center">
                <mat-icon
                  inline
                  aria-hidden="false"
                  aria-label="auto renew"
                  [style.color]="bookmark.iconColor"
                  [fontIcon]="bookmark.icon || 'star'"
                ></mat-icon>
              </button>
              <div class="w-full flex items-center text-left text-gray-700 pr-1">
                <span class="flex text-nowrap pr-2">{{ bookmark.listName }}</span>
                <div>({{ bookmark.list.length }})</div>
                <div class="flex gap-1 items-center ml-auto">
                  <button
                    class="transition hover:scale-110 flex items-center text-gray-400"
                    (click)="deleteList($event, bookmark)"
                    [disabled]="bookmark.isUpdating"
                  >
                    <mat-icon
                      [ngClass]="{ 'animate-spin': bookmark.isUpdating }"
                      inline
                      aria-hidden="false"
                      aria-label="delete icon"
                      [fontIcon]="bookmark.isUpdating ? 'autorenew' : 'delete'"
                    ></mat-icon>
                  </button>
                  <app-edit-marked-list-btn [disabled]="bookmark.isUpdating" [data]="bookmark">
                  </app-edit-marked-list-btn>
                </div>
              </div>
            </div>
          </p-accordion-header>
          <p-accordion-content>
            <div class="flex flex-col">
              @for (stall of bookmark.list; track $index) {
                <button
                  pButton
                  class="w-full !justify-start"
                  (click)="selectAndFocus(stall.id)"
                  size="small"
                  text="true"
                >
                  <app-stall-zone-badge [stall]="stall"></app-stall-zone-badge>
                  <span class="text-xs">{{ stall.stallTitle }} </span>
                </button>
              }
            </div>
          </p-accordion-content>
        </p-accordion-panel>
      }
    </p-accordion>
  </div>
}
