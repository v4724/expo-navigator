<ion-content class="ion-padding">
  <div class="flex flex-col h-full">
    <div class="flex flex-col">
      <div class="flex">
        <ion-searchbar
          placeholder="搜尋攤位編號、名稱、作者或標籤..."
          show-clear-button="never"
          (click)="toSearch()"
          [value]="currSearchTerm()"
        ></ion-searchbar>
        <div class="flex items-center pr-1">
          <ion-button
            class="ml-auto"
            aria-label="User"
            fill="outline"
            shape="round"
            id="user-modal-trigger"
            expand="block"
          >
            <ion-icon slot="icon-only" name="person" aria-hidden="true"></ion-icon>
          </ion-button>
          <app-user-modal> </app-user-modal>
        </div>
      </div>

      <div class="relative">
        <div class="absolute z-1 top-1 right-1 flex gap-2">
          @if (isFiltering()) {
            <div
              class="flex items-center p-2 rounded-full text-gray-600 bg-[radial-gradient(ellipse_80%_60%_at_center,white,transparent)]"
            >
              套用搜尋中 共 {{ results()?.length }} 筆
            </div>
            <p-button
              class="bg-white/80 rounded-full"
              [label]="`搜尋列表`"
              [rounded]="true"
              variant="outlined"
              (click)="resultList.show()"
            />
          }
        </div>
      </div>
    </div>
    <app-map class="flex-grow"></app-map>
  </div>
</ion-content>
<ion-footer>
  <ion-toolbar>
    <ion-buttons class="flex flex-row justify-between">
      <ion-button
        class=""
        [ngClass]="{ hidden: !isLogin(), 'w-1/2': isLogin() }"
        id="marked-list-sheet-trigger"
        expand="block"
      >
        書籤
      </ion-button>

      <ion-button
        class=""
        [ngClass]="{ 'w-full': !isLogin(), 'w-1/2': isLogin() }"
        id="control-layers-sheet-trigger"
        expand="block"
      >
        圖層
      </ion-button>

      <app-marked-list-sheet> </app-marked-list-sheet>
      <app-control-layers-sheet> </app-control-layers-sheet>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>

<app-stall-info-sheet> </app-stall-info-sheet>
<app-search-result-list-sheet #resultList></app-search-result-list-sheet>
