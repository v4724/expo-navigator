<div class="flex flex-col h-full">
  <div class="flex flex-col flex-grow">
    <div class="flex flex-col">
      <div class="flex">
        <ion-searchbar
          placeholder="搜尋攤位編號、名稱、作者或標籤..."
          show-clear-button="never"
          (click)="toSearch()"
          [value]="currSearchTerm()"
        ></ion-searchbar>
        <div class="flex items-center pr-1">
          <p-button
            icon="pi pi-user"
            [rounded]="true"
            [outlined]="true"
            (click)="userModal.show()"
          />
        </div>
      </div>

      <div class="relative">
        <div class="absolute z-1 top-1 right-1 flex gap-2">
          @if (isFiltering()) {
            <div
              class="flex items-center p-2 rounded-full text-gray-600 bg-[radial-gradient(ellipse_80%_60%_at_center,white,transparent)]"
            >
              套用搜尋中 共 {{ results()?.length }} 筆
            </div>
            <p-button
              class="bg-white/80 rounded-full"
              [label]="`搜尋列表`"
              [rounded]="true"
              variant="outlined"
              (click)="resultList.show()"
            />
          }
        </div>
      </div>
    </div>
    <app-map class="flex-grow"></app-map>
  </div>

  <div class="flex flex-row mt-auto justify-between h-12 shadow">
    <button
      pButton
      class="block"
      [ngClass]="{ hidden: !isLogin(), 'w-1/2': isLogin() }"
      (click)="markedListDrawer.show()"
    >
      書籤
    </button>
    <button pButton class="block" [ngClass]="{ 'w-full': !isLogin(), 'w-1/2': isLogin() }">
      圖層
    </button>
  </div>
</div>

<app-marked-list-drawer #markedListDrawer></app-marked-list-drawer>
<app-control-layers-sheet> </app-control-layers-sheet>
<app-user-modal #userModal> </app-user-modal>
<app-stall-info-sheet> </app-stall-info-sheet>
<app-search-result-list-sheet #resultList></app-search-result-list-sheet>
